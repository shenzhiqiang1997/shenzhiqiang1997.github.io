---
title: 在浏览器中输入网址按下回车会发生什么
date: 2018-11-07 21:08:00
tags: 
    - 计算机网络
    - 面试题
categories:
    - 计算机网络
---
# 概述
一道经典的计算机网络面试题，一般来说越详细越好，能够凸显出基础功底。
<!-- more -->
# 流程
1. 检查浏览器的DNS缓存/操作系统的DNS缓存中是否有对应域名的IP
2. 如果没有，则要考虑向DNS服务器发送DNS查询报文。
3. 发送DNS查询报文之前要先检查DNS服务器是否在子网中，可以通过子网掩码和DNS服务器的IP做与操作来进行判断。
4. 如果DNS服务器跟当前主机在一个子网，则需要向DNS服务器发送DNS查询报文；否则，需要向网关路由器发送DNS查询报文，由网关路由器转发到外网的DNS服务器。下面将上面两种情况的发送目标目标主机。
5. 在发送DNS查询报文之前还要先检查ARP缓存中是否有目标主机IP对应的MAC地址，如果没有，要先通过ARP协议获取到目标主机的MAC地址才能成帧。
6. 主机广播一个以目标主机为目的IP的ARP查询报文，当目标主机接收之后，发现该ARP查询报文的目的IP是自己的IP，则会将自己的IP和MAC地址封装到ARP响应报文中发送回主机。
7. 主机向目的主机发送DNS查询报文，它封装成的帧的目的MAC地址为刚刚获取到的那个MAC地址。
8. 当DNS查询报文到达DNS服务器之后，DNS服务器首先检查本地是否有对应的DNS缓存。
9. 如果没有则将会通过轮询或者递归的方式向根、顶级、权威服务器查询到域名对应的IP。然后将域名和对应的IP封装到DNS响应报文中传送回主机。
9. 之后主机向服务器进行三次握手建立TCP连接，通过该TCP连接发送HTTP请求报文。
10. 服务器接收到HTTP请求后将请求的文档放在HTTP响应报文的body中发送回主机。
11. 主机接收到HTTP响应报文之后将文档取出，再根据文档中引用的对象，向服务器发送HTTP请求请求这些对象。
12. 当接收完这些对象之后，浏览器将文档和对象解析和渲染，然后在不需要这个TCP连接的时候通过四次挥手释放掉，完成整个过程。