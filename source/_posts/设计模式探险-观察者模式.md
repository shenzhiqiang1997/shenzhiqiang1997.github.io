---
title: 设计模式探险-观察者模式
date: 2018-08-28 17:04:00
tags: 
    - 设计模式
    - Java
categories: 
    - 设计模式
---
# 观察者模式
## 什么是观察者模式
定义对象间的一对多依赖，当被观察者的状态发生改变时通知观察者，观察者能接收到被观察者的最新状态。
<!-- more -->
## 实现方式
被观察者维护一个观察者列表，并暴露接口给观察者进行注册或者注销。观察者暴露一个接口给被观察者，当被观察者状态发生改变时，遍历自己的观察者列表，通过观察者提供的接口将最新的状态推送给观察者。
## 实现代码
```java
/* 
    这里考虑的是温度计观察温度的场景
    被观察者被称为主题
*/
public interface Subject {
    void registerObserver(Observer o);
    void removeObserver(Observer o);
    void notifyObservers();
}

public interface Observer {
    void update(double template);
}

public class Temperature implements Subject{
    private double temp;
    private List<Observer> observers = new ArrayList<>();

    public Temperature(double temp){
        this.temp = temp;
    }

    public void setTemp(double temp) {
        this.temp = temp;
        notifyObservers();
    }

    @Override
    public void registerObserver(Observer o) {
        observers.add(o);
    }

    @Override
    public void removeObserver(Observer o) {
        observers.remove(o);
    }

    @Override
    public void notifyObservers() {
        for (Observer observer:
             observers) {
            observer.update(temp);
        }
    }
}

public class TemperatureObserver implements Observer {

    private Temperature temperature;

    public TemperatureObserver(Temperature temperature){
        this.temperature = temperature;
        temperature.registerObserver(this);
    }

    @Override
    public void update(double template) {
        System.out.println("temperature change: "+template);
    }
}

public class ObserverTest {
    public static void main(String[] args) {
        Temperature temperature = new Temperature(32);
        for (int i = 0; i < 10; i++) {
            TemperatureObserver to = new TemperatureObserver(temperature);
        }
        temperature.setTemp(24);
    }
}
```
